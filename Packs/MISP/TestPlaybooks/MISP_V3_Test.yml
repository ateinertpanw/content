id: MISP V3 Test
version: 23
vcShouldKeepItemLegacyProdMachine: false
name: MISP V3 Test
description: Test playbook for MISP V3 integration
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 600269cb-7685-4123-8fb0-ce3489be9555
    type: start
    task:
      id: 600269cb-7685-4123-8fb0-ce3489be9555
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 2888b539-a9c8-4dd7-8858-5d2e030dd858
    type: regular
    task:
      id: 2888b539-a9c8-4dd7-8858-5d2e030dd858
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: b663e0aa-1e17-4a74-82b2-57882451ee39
    type: regular
    task:
      id: b663e0aa-1e17-4a74-82b2-57882451ee39
      version: -1
      name: misp-search-events by event_id
      script: '|||misp-search-events'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
      limit:
        simple: "1"
      page:
        simple: "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 658f9d58-f55b-4d2a-83d6-d23a70c2219a
    type: condition
    task:
      id: 658f9d58-f55b-4d2a-83d6-d23a70c2219a
      version: -1
      name: Verify Search Event Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "16"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
          right:
            value:
              simple: ${MISP.Event.ID}
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.Distribution
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.ThreatLevelID
            iscontext: true
          right:
            value:
              simple: "3"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.Info
            iscontext: true
          right:
            value:
              simple: TPB-New-Event
      - - operator: greaterThanOrEqual
          left:
            value:
              simple: MISP.Event.AttributeCount
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Analysis
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.SharingGroupID
            iscontext: true
          right:
            value:
              simple: "0"
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: d7b3ec2c-f9a2-4f1d-88dc-2b4e212b7917
    type: regular
    task:
      id: d7b3ec2c-f9a2-4f1d-88dc-2b4e212b7917
      version: -1
      name: domain
      description: Checks the reputation of the given domain.
      script: MISP V3|||domain
      type: regular
      iscommand: true
      brand: MISP V3
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      domain:
        simple: google.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5035
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: cc0a195c-c21b-4713-83ec-9b9c509ee629
    type: condition
    task:
      id: cc0a195c-c21b-4713-83ec-9b9c509ee629
      version: -1
      name: Verify  Domain Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "51"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Domain.Name
            iscontext: true
          right:
            value:
              simple: google.com
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: domain
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
        - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "3"
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: google.com
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 34c33dfa-dc10-43ef-8277-b33f8de7a1a5
    type: regular
    task:
      id: 34c33dfa-dc10-43ef-8277-b33f8de7a1a5
      version: -1
      name: email
      description: Checks the reputation of the given email address.
      script: MISP V3|||email
      type: regular
      iscommand: true
      brand: MISP V3
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      email:
        simple: email@email.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5035
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 01b77d80-e581-4686-84ff-715718f6a946
    type: condition
    task:
      id: 01b77d80-e581-4686-84ff-715718f6a946
      version: -1
      name: Verify Email Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "51"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Email.Address
            iscontext: true
          right:
            value:
              simple: email@email.com
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: email@email.com
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: email
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
        - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "3"
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 63536b11-bbc0-40e3-8604-7392a65a33b5
    type: regular
    task:
      id: 63536b11-bbc0-40e3-8604-7392a65a33b5
      version: -1
      name: file
      description: Checks the file reputation of the given hash.
      script: MISP V3|||file
      type: regular
      iscommand: true
      brand: MISP V3
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      file:
        simple: 098f6bcd4621d373cade4e832627b4f6
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5035
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 93e1eb33-8d82-405b-8517-b4ee7ea116f2
    type: condition
    task:
      id: 93e1eb33-8d82-405b-8517-b4ee7ea116f2
      version: -1
      name: Verify File Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "51"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: File.MD5
            iscontext: true
          right:
            value:
              simple: 098f6bcd4621d373cade4e832627b4f6
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: 098f6bcd4621d373cade4e832627b4f6
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: file
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
        - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "3"
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 7aee63db-3ee0-47af-864a-2de6551985bb
    type: regular
    task:
      id: 7aee63db-3ee0-47af-864a-2de6551985bb
      version: -1
      name: url
      description: Checks the reputation of the given URL.
      script: MISP V3|||url
      type: regular
      iscommand: true
      brand: MISP V3
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      url:
        simple: www.example.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 5035
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: cdc4ebcb-1c4d-46e5-8f72-2f4c848dd202
    type: condition
    task:
      id: cdc4ebcb-1c4d-46e5-8f72-2f4c848dd202
      version: -1
      name: 'Verify URL Outputs '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "51"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: URL.Data
            iscontext: true
          right:
            value:
              simple: www.example.com
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: www.example.com
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: url
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
        - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "3"
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 5210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 2a6f671b-5d6a-45b3-8faa-657f6d17ac61
    type: regular
    task:
      id: 2a6f671b-5d6a-45b3-8faa-657f6d17ac61
      version: -1
      name: ip
      description: Checks the reputation of an IP address.
      script: MISP V3|||ip
      type: regular
      iscommand: true
      brand: MISP V3
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      ip:
        simple: 1.2.3.4
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 5035
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 3e29c52e-270c-4f66-83fa-08152875c36d
    type: condition
    task:
      id: 3e29c52e-270c-4f66-83fa-08152875c36d
      version: -1
      name: Verify IP Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "51"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: IP.Address
            iscontext: true
          right:
            value:
              simple: 1.2.3.4
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: 1.2.3.4
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: ip
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
        - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "3"
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 5210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: a8ffddb1-8cfb-4e43-827b-bf03e0c7b587
    type: regular
    task:
      id: a8ffddb1-8cfb-4e43-827b-bf03e0c7b587
      version: -1
      name: misp-create-event
      script: '|||misp-create-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "68"
    scriptarguments:
      info:
        simple: TPB-New-Event
      threat_level_id:
        simple: Low
      value:
        simple: 1.1.1.1
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 2819858a-416b-4f24-8782-fcc3476cbc88
    type: condition
    task:
      id: 2819858a-416b-4f24-8782-fcc3476cbc88
      version: -1
      name: Verify New Event Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "2"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.Distribution
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.ThreatLevelID
            iscontext: true
          right:
            value:
              simple: "3"
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.EventCreatorEmail
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.Info
            iscontext: true
          right:
            value:
              simple: TPB-New-Event
      - - operator: greaterThanOrEqual
          left:
            value:
              simple: MISP.Event.AttributeCount
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.OrganizationID
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.Organization.ID
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.Organization.Name
            iscontext: true
          right:
            value:
              simple: ORGNAME
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Organization.UUID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.OwnerOrganization.ID
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.OwnerOrganization.Name
            iscontext: true
          right:
            value:
              simple: ORGNAME
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.OwnerOrganization.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.LastChanged
            iscontext: true
      - - operator: isFalse
          left:
            value:
              simple: MISP.Event.Published
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.UUID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.Analysis
            iscontext: true
          right:
            value:
              simple: "0"
    view: |-
      {
        "position": {
          "x": 910,
          "y": 865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 3e906dce-9fdd-4f6e-8d25-53eb7a40d77e
    type: regular
    task:
      id: 3e906dce-9fdd-4f6e-8d25-53eb7a40d77e
      version: -1
      name: misp-add-attribute
      script: '|||misp-add-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      comment:
        simple: test-add-attribute
      event_id:
        simple: ${MISP.Event.ID}
      value:
        simple: "10"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: d6854c71-ec00-4ad4-840a-254629f67a3b
    type: condition
    task:
      id: d6854c71-ec00-4ad4-840a-254629f67a3b
      version: -1
      name: Verify Add Attribute Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "65"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.Distribution
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Value
            iscontext: true
          right:
            value:
              simple: "10"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.EventID
            iscontext: true
          right:
            value:
              simple: ${MISP.Event.ID}
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.LastChanged
            iscontext: true
      - - operator: isFalse
          left:
            value:
              simple: MISP.Attribute.Deleted
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Type
            iscontext: true
          right:
            value:
              simple: other
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.UUID
            iscontext: true
      - - operator: isTrue
          left:
            value:
              simple: MISP.Attribute.ToIDs
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Category
            iscontext: true
          right:
            value:
              simple: External analysis
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Comment
            iscontext: true
          right:
            value:
              simple: test-add-attribute
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Event.ID
            iscontext: true
          right:
            value:
              simple: ${MISP.Event.ID}
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Event.Distribution
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Event.Info
            iscontext: true
          right:
            value:
              simple: TPB-New-Event
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.Event.UUID
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 08737857-8763-48c5-8bd3-b532909ab7c6
    type: regular
    task:
      id: 08737857-8763-48c5-8bd3-b532909ab7c6
      version: -1
      name: misp-add-tag-to-event
      script: '|||misp-add-tag-to-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      tag:
        simple: EventTag
      uuid:
        simple: ${MISP.Event.UUID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 6055
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 3d6a517b-bdb9-4e26-884f-476b96e18673
    type: condition
    task:
      id: 3d6a517b-bdb9-4e26-884f-476b96e18673
      version: -1
      name: Verify Event Tags
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "60"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Info
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Analysis
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.Tag.Name
            iscontext: true
          right:
            value:
              simple: EventTag
      - - operator: isFalse
          left:
            value:
              simple: MISP.Event.Tag.is_galaxy
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 6230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: d73c3a24-3d15-4229-89d6-0d8de2438e85
    type: regular
    task:
      id: d73c3a24-3d15-4229-89d6-0d8de2438e85
      version: -1
      name: misp-add-tag-to-attribute
      script: '|||misp-add-tag-to-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      tag:
        simple: TestPlaybook
      uuid:
        simple: ${MISP.Attribute.UUID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 0a613094-f183-4669-8774-083204aca0c4
    type: condition
    task:
      id: 0a613094-f183-4669-8774-083204aca0c4
      version: -1
      name: Verify Attribute Tags
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "61"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Value
            iscontext: true
          right:
            value:
              simple: "10"
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.UUID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Tag.Name
            iscontext: true
          right:
            value:
              simple: TestPlaybook
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: d3958046-ade3-45ea-892c-047f31c18753
    type: regular
    task:
      id: d3958046-ade3-45ea-892c-047f31c18753
      version: -1
      name: misp-add-sighting
      script: '|||misp-add-sighting'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      id:
        simple: ${MISP.Attribute.ID}
      type:
        simple: sighting
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2265
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: d43524bb-d98f-4010-86b0-d1adcdaf4001
    type: regular
    task:
      id: d43524bb-d98f-4010-86b0-d1adcdaf4001
      version: -1
      name: misp-add-events-from-feed
      script: '|||misp-add-events-from-feed'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "62"
    scriptarguments:
      feed:
        simple: Botvrij.eu
      limit:
        simple: "0"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4015
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: a1c9c6b4-1da6-456c-8ddb-97a04fe28f54
    type: regular
    task:
      id: a1c9c6b4-1da6-456c-8ddb-97a04fe28f54
      version: -1
      name: misp-add-file-object
      script: '|||misp-add-file-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    scriptarguments:
      entry_id:
        simple: ${File.EntryID}
      event_id:
        simple: ${MISP.Event.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 8685
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: a5ed7387-39d9-44d7-8385-6240bdfcb16f
    type: regular
    task:
      id: a5ed7387-39d9-44d7-8385-6240bdfcb16f
      version: -1
      name: misp-add-domain-object
      script: '|||misp-add-domain-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      dns:
        simple: 2.2.2.2
      event_id:
        simple: ${MISP.Event.ID}
      ip:
        simple: 2.2.2.2
      name:
        simple: example.com
      text:
        simple: DomainTPB
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 8160
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 39c77c11-3add-4a5e-8cf3-796991850e68
    type: condition
    task:
      id: 39c77c11-3add-4a5e-8cf3-796991850e68
      version: -1
      name: Verify Domain Obj Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "58"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
      - - operator: in
          left:
            value:
              simple: domain-ip
          right:
            value:
              simple: MISP.Event.Object.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Description
            iscontext: true
      - - operator: in
          left:
            value:
              simple: 2.2.2.2
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
      - - operator: in
          left:
            value:
              simple: example.com
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
      - - operator: in
          left:
            value:
              simple: DomainTPB
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 8335
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: d72565c5-dda8-43d2-8121-3052f615f4ae
    type: regular
    task:
      id: d72565c5-dda8-43d2-8121-3052f615f4ae
      version: -1
      name: misp-add-url-object
      script: '|||misp-add-url-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
      text:
        simple: URLTPB
      url:
        simple: www.example.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 7810
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: c8696761-172f-4308-8556-843a1e4f1db7
    type: regular
    task:
      id: c8696761-172f-4308-8556-843a1e4f1db7
      version: -1
      name: misp-add-object
      script: '|||misp-add-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "57"
    scriptarguments:
      attributes:
        simple: '{''description'': ''Manager Ferrari'', ''make'': ''Ferrari'', ''model'':
          ''308 GTS''}'
      event_id:
        simple: ${MISP.Event.ID}
      template:
        simple: vehicle
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 7460
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: aa9e2b8d-2082-47f6-83b8-226c8376e72d
    type: regular
    task:
      id: aa9e2b8d-2082-47f6-83b8-226c8376e72d
      version: -1
      name: misp-add-ip-object
      script: '|||misp-add-ip-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "56"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
      ip:
        simple: 3.3.3.3
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 6580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: d6e78a05-18d6-4f47-8c8a-ba18353e5b35
    type: regular
    task:
      id: d6e78a05-18d6-4f47-8c8a-ba18353e5b35
      version: -1
      name: misp-search-attributes only values
      script: '|||misp-search-attributes'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      compact:
        simple: "true"
      type:
        simple: other
      value:
        simple: "10"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2965
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 68313fc0-c881-4bef-835a-41d0e6df1a29
    type: condition
    task:
      id: 68313fc0-c881-4bef-835a-41d0e6df1a29
      version: -1
      name: Verify Search Attribute Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "42"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: in
          left:
            value:
              simple: "10"
          right:
            value:
              simple: ${MISP.Attribute}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 729e1d16-82d1-4be1-88e2-5bf0e60ade4d
    type: title
    task:
      id: 729e1d16-82d1-4be1-88e2-5bf0e60ade4d
      version: -1
      name: Test Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 9210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 2a15ddbc-15a8-4520-8912-6d146bea4535
    type: regular
    task:
      id: 2a15ddbc-15a8-4520-8912-6d146bea4535
      version: -1
      name: misp-search-attributes full output
      script: '|||misp-search-attributes'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      compact:
        simple: "false"
      include_sightings:
        simple: "true"
      limit:
        simple: "1"
      page:
        simple: "1"
      type:
        simple: other
      value:
        simple: "10"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3490
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: c364cff3-882a-423d-85e2-3cc08a146064
    type: condition
    task:
      id: c364cff3-882a-423d-85e2-3cc08a146064
      version: -1
      name: Verify Search Attribute Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "67"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.Distribution
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Value
            iscontext: true
          right:
            value:
              simple: "10"
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.EventID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Type
            iscontext: true
          right:
            value:
              simple: other
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.UUID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Category
            iscontext: true
          right:
            value:
              simple: Person
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Comment
            iscontext: true
          right:
            value:
              simple: updated comment
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.Event.ID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Event.Info
            iscontext: true
          right:
            value:
              simple: TPB-New-Event
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.Event.UUID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Sighting.Type
            iscontext: true
          right:
            value:
              simple: "0"
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3665
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: eaa61f64-80a8-4907-81b3-6e0391873c6f
    type: regular
    task:
      id: eaa61f64-80a8-4907-81b3-6e0391873c6f
      version: -1
      name: Delete Attribute Context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      key:
        simple: MISP.Attribute
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: cb8fda9c-b4f9-41c1-80fe-61b9227c9a28
    type: regular
    task:
      id: cb8fda9c-b4f9-41c1-80fe-61b9227c9a28
      version: -1
      name: Delete Attribute Context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      key:
        simple: MISP.Attribute
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3315
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: cfe118ec-8fa9-4b98-8a87-24a573758ba7
    type: regular
    task:
      id: cfe118ec-8fa9-4b98-8a87-24a573758ba7
      version: -1
      name: 'misp-add-attribute domain '
      script: '|||misp-add-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
      value:
        simple: google.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: a1d52ada-a785-4853-8b03-61d8d6fb8d9e
    type: regular
    task:
      id: a1d52ada-a785-4853-8b03-61d8d6fb8d9e
      version: -1
      name: 'misp-add-attribute email '
      script: '|||misp-add-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
      value:
        simple: email@email.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: 04fb83ac-e32a-4516-8de2-264a25bb077b
    type: regular
    task:
      id: 04fb83ac-e32a-4516-8de2-264a25bb077b
      version: -1
      name: 'misp-add-attribute file '
      script: '|||misp-add-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
      value:
        simple: 098f6bcd4621d373cade4e832627b4f6
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: ecaef021-19bb-4732-8d0a-cb25fdc7ef44
    type: regular
    task:
      id: ecaef021-19bb-4732-8d0a-cb25fdc7ef44
      version: -1
      name: 'misp-add-attribute ip '
      script: '|||misp-add-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
      value:
        simple: 1.2.3.4
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 4860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: f55ff3f4-3549-4459-842b-c76d8ba8dbf6
    type: regular
    task:
      id: f55ff3f4-3549-4459-842b-c76d8ba8dbf6
      version: -1
      name: misp-add-attribute url
      script: '|||misp-add-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
      value:
        simple: www.example.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 4860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: eba5322d-ef08-4ba8-8135-3ee115852e68
    type: condition
    task:
      id: eba5322d-ef08-4ba8-8135-3ee115852e68
      version: -1
      name: Verify URL Obj Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.MetaCategory
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Distribution
            iscontext: true
      - - operator: in
          left:
            value:
              simple: url
          right:
            value:
              simple: ${MISP.Event.Object.Name}
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Description
            iscontext: true
      - - operator: in
          left:
            value:
              simple: www.example.com
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
      - - operator: in
          left:
            value:
              simple: www.example.com
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
      - - operator: in
          left:
            value:
              simple: URLTPB
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 7980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 42265297-3ff2-4c78-8d9d-8945c7f6e465
    type: title
    task:
      id: 42265297-3ff2-4c78-8d9d-8945c7f6e465
      version: -1
      name: Reputation Commands
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "43"
      - "44"
      - "45"
      - "46"
      - "47"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4715
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: eef73e60-24cd-42ff-823a-4d54d1f5812d
    type: title
    task:
      id: eef73e60-24cd-42ff-823a-4d54d1f5812d
      version: -1
      name: MISP Commands
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: 35e6be60-19dc-487b-83f5-b5af40c2b06a
    type: regular
    task:
      id: 35e6be60-19dc-487b-83f5-b5af40c2b06a
      version: -1
      name: Delete Event
      description: Deletes an event according to the given event ID.
      script: '|||misp-delete-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 5a851c95-fc08-4c77-8106-008c3a82d0ed
    type: title
    task:
      id: 5a851c95-fc08-4c77-8106-008c3a82d0ed
      version: -1
      name: Object Commands
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "53"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: d1ec2f28-17ec-40c0-89b0-69c5c61abf23
    type: regular
    task:
      id: d1ec2f28-17ec-40c0-89b0-69c5c61abf23
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "55"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5705
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 02ec90af-9b0e-44e8-8ec4-5e145d45f87b
    type: regular
    task:
      id: 02ec90af-9b0e-44e8-8ec4-5e145d45f87b
      version: -1
      name: Delete Event
      description: Deletes an event according to the given event ID.
      script: '|||misp-delete-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 9035
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 006ca87d-a4b6-4ba5-83b1-9123770362ff
    type: regular
    task:
      id: 006ca87d-a4b6-4ba5-83b1-9123770362ff
      version: -1
      name: misp-create-event
      script: '|||misp-create-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      info:
        simple: TPB-New-Event
      threat_level_id:
        simple: Low
      value:
        simple: 1.1.1.1
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: 4bcc7b5a-4adf-44d9-8cf8-19aab185f182
    type: condition
    task:
      id: 4bcc7b5a-4adf-44d9-8cf8-19aab185f182
      version: -1
      name: Verify IP Obj Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "69"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.MetaCategory
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Distribution
            iscontext: true
      - - operator: in
          left:
            value:
              simple: ip-port
          right:
            value:
              simple: ${MISP.Event.Object.Name}
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Description
            iscontext: true
      - - operator: in
          left:
            value:
              simple: 3.3.3.3
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 6755
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: ed88b75a-2cf2-400a-8341-4518088f9036
    type: condition
    task:
      id: ed88b75a-2cf2-400a-8341-4518088f9036
      version: -1
      name: Verify Object Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "30"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.MetaCategory
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Distribution
            iscontext: true
      - - operator: in
          left:
            value:
              simple: vehicle
          right:
            value:
              simple: MISP.Event.Object.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Description
            iscontext: true
      - - operator: in
          left:
            value:
              simple: Manager Ferrari
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
      - - operator: in
          left:
            value:
              simple: Ferrari
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
      - - operator: in
          left:
            value:
              simple: 308 GTS
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 7635
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 5d2ef955-4b26-4ec9-8d57-125142a4b97d
    type: regular
    task:
      id: 5d2ef955-4b26-4ec9-8d57-125142a4b97d
      version: -1
      name: get file
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      method:
        simple: GET
      saveAsFile:
        simple: "yes"
      url:
        simple: https://github.com/demisto/content/blob/master/TestData/regular_english_file.txt
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 8510
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 31f4ba79-f600-4ca7-8025-48b991884f7a
    type: condition
    task:
      id: 31f4ba79-f600-4ca7-8025-48b991884f7a
      version: -1
      name: Verify File Obj Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "54"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
      - - operator: in
          left:
            value:
              simple: file
          right:
            value:
              simple: MISP.Event.Object.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Description
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 8860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: d1ba748a-fcac-489e-8bcf-83c45352db83
    type: regular
    task:
      id: d1ba748a-fcac-489e-8bcf-83c45352db83
      version: -1
      name: Remove Event Tag
      description: Removes a tag from the given UUID event .
      script: '|||misp-remove-tag-from-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      tag:
        simple: EventTag
      uuid:
        simple: ${MISP.Event.UUID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 6405
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: beedfbb1-8690-4fd9-89cd-c80331f7717b
    type: regular
    task:
      id: beedfbb1-8690-4fd9-89cd-c80331f7717b
      version: -1
      name: Remove Attribute Tag
      description: Removes a tag from the given UUID attribute .
      script: '|||misp-remove-tag-from-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      tag:
        simple: TestPlaybook
      uuid:
        simple: ${MISP.Attribute.UUID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: e00ea843-89d7-4d82-8e76-bb955671e6da
    type: regular
    task:
      id: e00ea843-89d7-4d82-8e76-bb955671e6da
      version: -1
      name: Delete Event
      description: Deletes an event according to the given event ID.
      script: '|||misp-delete-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "64"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: e3c12873-88b3-4050-8dad-e075f9c17383
    type: regular
    task:
      id: e3c12873-88b3-4050-8dad-e075f9c17383
      version: -1
      name: misp-create-event
      script: '|||misp-create-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      info:
        simple: TPB-New-Event
      threat_level_id:
        simple: Low
      value:
        simple: 1.1.1.1
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: 116085e1-1cc7-4016-869d-311556a5a4a6
    type: regular
    task:
      id: 116085e1-1cc7-4016-869d-311556a5a4a6
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "63"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4365
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 633375c4-a3f0-4065-8d8d-63b48f846e25
    type: regular
    task:
      id: 633375c4-a3f0-4065-8d8d-63b48f846e25
      version: -1
      name: Update attribute
      description: Update an attribute of an existing MISP event.
      script: '|||misp-update-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "66"
    scriptarguments:
      attribute_uuid:
        simple: ${MISP.Attribute.UUID}
      category:
        simple: Person
      comment:
        simple: updated comment
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: 649543dd-9c6c-4f1e-86e4-f47fec188480
    type: condition
    task:
      id: 649543dd-9c6c-4f1e-86e4-f47fec188480
      version: -1
      name: Verify Update Attribute Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.Distribution
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Value
            iscontext: true
          right:
            value:
              simple: "10"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.EventID
            iscontext: true
          right:
            value:
              simple: ${MISP.Event.ID}
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.LastChanged
            iscontext: true
      - - operator: isFalse
          left:
            value:
              simple: MISP.Attribute.Deleted
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Type
            iscontext: true
          right:
            value:
              simple: other
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.UUID
            iscontext: true
      - - operator: isTrue
          left:
            value:
              simple: MISP.Attribute.ToIDs
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Category
            iscontext: true
          right:
            value:
              simple: Person
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Comment
            iscontext: true
          right:
            value:
              simple: updated comment
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Event.ID
            iscontext: true
          right:
            value:
              simple: ${MISP.Event.ID}
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Event.Distribution
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Event.Info
            iscontext: true
          right:
            value:
              simple: TPB-New-Event
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.Event.UUID
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: 9168cb5b-9174-453d-80f5-1e4337e1614b
    type: regular
    task:
      id: 9168cb5b-9174-453d-80f5-1e4337e1614b
      version: -1
      name: Delete Attribute
      description: Delete an attribute according to the given attribute ID.
      script: '|||misp-delete-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      attribute_id:
        simple: ${MISP.Attribute.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3840
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: a51f9196-b9d4-49ce-847d-f9512c119e24
    type: regular
    task:
      id: a51f9196-b9d4-49ce-847d-f9512c119e24
      version: -1
      name: misp-publish-event
      description: Publish an event.
      script: '|||misp-publish-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "50"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: 3088021a-6540-4e13-8128-cfb378465123
    type: regular
    task:
      id: 3088021a-6540-4e13-8128-cfb378465123
      version: -1
      name: Get EMail
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "70"
    scriptarguments:
      method:
        simple: GET
      saveAsFile:
        simple: "yes"
      url:
        simple: https://raw.githubusercontent.com/demisto/content/master/TestData/CheckEmailAuthenticity_test_mail.eml
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 6935
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "70":
    id: "70"
    taskid: c5754559-e07f-482a-8327-7202f5a6866a
    type: regular
    task:
      id: c5754559-e07f-482a-8327-7202f5a6866a
      version: -1
      name: Add EMail object
      description: adds an email object to given event id
      script: '|||misp-add-email-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "72"
    scriptarguments:
      entry_id:
        simple: ${File.EntryID}
      event_id:
        simple: ${MISP.Event.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 7100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: 226b347f-3ba8-4630-856e-df8bad92cd19
    type: condition
    task:
      id: 226b347f-3ba8-4630-856e-df8bad92cd19
      version: -1
      name: Verify Email Obj Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "32"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.MetaCategory
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Distribution
            iscontext: true
      - - operator: in
          left:
            value:
              simple: email
          right:
            value:
              simple: MISP.Event.Object.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Description
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 7275
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "29_58_yes": 0.34,
      "48_28_yes": 0.52,
      "56_69_yes": 0.28
    },
    "paper": {
      "dimensions": {
        "height": 9225,
        "width": 2100,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
